{"title":"Off-line recognition of realistic Chinese handwriting using segmentation-free strategy","slug":"Off-line-recognition-of-realistic-Chinese-handwriting-using-segmentation-free-strategy","date":"2021-09-28T02:37:03.000Z","updated":"2021-09-28T03:07:25.544Z","comments":true,"path":"api/articles/Off-line-recognition-of-realistic-Chinese-handwriting-using-segmentation-free-strategy.json","photos":[],"link":"","excerpt":"pattern recognitionOff-line recognition of realistic Chinese handwriting using segmentation-free strategyTong-Hua Su∗, Tian-Wen Zhang, De-Jun Guan, Hu-Jie HuangKeywords: Optical character recognition(光学字符识别) Chinese handwriting recognition(中文手写字识别) Sliding window(滑动窗口) Hidden Markov Model(隐马尔可夫模型) Segmentation-free strategy(无分割策略) Classifier combination(分类器组合)","covers":["../static/images/model-SRM.png","../static/images/model-Backbone.png","../static/images/feature-map.png","../static/images/model-branch.png","../static/images/datasets.png","../static/images/metric1.png","../static/images/metric2.png"],"content":"<center><font size=4px>pattern recognition</font></center>\n\n<h4 id=\"Off-line-recognition-of-realistic-Chinese-handwriting-using-segmentation-free-strategy\"><a href=\"#Off-line-recognition-of-realistic-Chinese-handwriting-using-segmentation-free-strategy\" class=\"headerlink\" title=\"Off-line recognition of realistic Chinese handwriting using segmentation-free strategy\"></a>Off-line recognition of realistic Chinese handwriting using segmentation-free strategy</h4><center>Tong-Hua Su∗, Tian-Wen Zhang, De-Jun Guan, Hu-Jie Huang</center>\n\n<p><strong>Keywords:</strong> Optical character recognition(光学字符识别) Chinese handwriting recognition(中文手写字识别) Sliding window(滑动窗口) Hidden Markov Model(隐马尔可夫模型) Segmentation-free strategy(无分割策略) Classifier combination(分类器组合)</p>\n<span id=\"more\"></span>\n\n<h4 id=\"网络结构\"><a href=\"#网络结构\" class=\"headerlink\" title=\"网络结构\"></a>网络结构</h4><center><img src=\"../static/images/model-SRM.png\"></center>\n\n<center><strong>网络架构图</strong></center>\n\n<p>卷积层的优点：</p>\n<p>  由于卷积层的局部可连通性，全卷积网络可以在不用改变其宽高比的前提下，以相适应的速度处理不同大小的图片并且在相关局部区域做预测。</p>\n<ul>\n<li><p>网络同时产生分割和识别结果。</p>\n</li>\n<li><p>Network Architecture(Backbone Network + Segmentation and Recognition Module)</p>\n<ul>\n<li>BackBone Network：主要是提取图像特征，在本文中是利用3x3的连续卷积层和残差模型(residual module)来进行提取</li>\n</ul>\n<center><img src=\"../static/images/model-Backbone.png\" height=\"480\"></center>\n\n<center><strong>主干网络</strong></center>\n\n<ul>\n<li><p>SRM(分割和识别模型)：包含detection、location、classification 三个分支，同时输出分割和识别结果</p>\n<img src=\"../static/images/feature-map.png\">\n\n<h5 id=\"Location\"><a href=\"#Location\" class=\"headerlink\" title=\"Location:\"></a><strong>Location:</strong></h5><ol>\n<li>Location层是整个模型表现好坏的关键，虽然是分别的三个任务，但三个任务是紧密相关的，Detection和Classification可以帮助判断字符的存在。</li>\n<li>Detection和Classification分支的特征向量经过一个1x1的Conv后加入Location分支的特征向量中，新产生的特征向量输入到一个1x1的Conv中然后产生新的特征向量$l^p$，利用sigmoid对它进行激活，得到字符位置置信向量$L^p$，每个$L^p$代表了字符在这个对应网格中存在的置信度。</li>\n<li>在location分支中采用了二元交叉熵损失函数(binary cross entropy loss)。</li>\n<li>一个字符只有当其中心点在这个网格范围内才能被视为处在这个网格，因为不存在字(negative)的网格比存在字(positive)的网格更多，所以对两者的样本分别取损失的平均值。</li>\n</ol>\n<h5 id=\"Detection\"><a href=\"#Detection\" class=\"headerlink\" title=\"Detection:\"></a>Detection:</h5><ol>\n<li><p>直接探测了字符的宽高比</p>\n</li>\n<li><p>预测左上角点的偏移量(offset)</p>\n</li>\n<li><p>边框和原始图像的关系：</p>\n<ul>\n<li><p>$$<br>x_b = \\frac{i-1+sigmoid(x_i^p)}{L_{fv}} *W<br>$$</p>\n</li>\n<li><p>$$<br>y_b = sigmoid(y_i^p)*H<br>$$</p>\n</li>\n<li><p>$$<br>w_b = w_i^p * H<br>$$</p>\n</li>\n<li><p>$$<br>h_b = sigmoid(h_i^p) * H<br>$$</p>\n</li>\n</ul>\n</li>\n</ol>\n<p>$loss = Mean \\ square \\ error$，只有当字符被判断为在这个网格中时才计算loss。</p>\n<h5 id=\"Classification\"><a href=\"#Classification\" class=\"headerlink\" title=\"Classification:\"></a>Classification:</h5><ol>\n<li>中文字符分类有7456个类别，需要生成更多的特征向量，利用1024个特征向量生成7536x$L_{fv}$的matrix，最后通过softmax输出每个grid对于每个分类的概率，并且采用交叉熵损失来优化分类（和detection分支相同，不存在字符的grid会被直接忽略）。</li>\n</ol>\n<p><strong>Transcription</strong>:</p>\n<ol>\n<li>无语言模型：集合了位置置信度和分类概率共同形成如方程所示的检测结果：</li>\n</ol>\n<p>$$</p>\n<pre><code>Conf_i^&#123;bbox&#125; = 0.8 * L_i^p + 0.2 * \\max (p_i^&#123;c_1&#125;,p_i^&#123;c_2&#125;,...,p_i^&#123;c_7356&#125;) \n</code></pre>\n<p>$$</p>\n<ol start=\"2\">\n<li>有语言模型：本文使用了back-off 三元语言模型。<ul>\n<li>语料库：人民日报(2199492个汉字)，新华社(3697028个汉字)，应用语言学研究所(5千万个汉字)</li>\n<li>利用集束搜索来进行转录。</li>\n<li>bouding boxes：($x_i^p,y_i^p，w_i^p，h_i^p$)，表示$ith$个grid。</li>\n<li>$L_{fv} = \\frac{W_i}{16}, L_{fv}$是特征向量的长度，grid(即上图的网格)宽高比(ratio)是0.125。</li>\n</ul>\n</li>\n</ol>\n</li>\n</ul>\n<img src=\"../static/images/model-branch.png\"></li>\n</ul>\n<center><strong>基于特征向量的预测机制</strong></center>\n\n<h4 id=\"实验结果\"><a href=\"#实验结果\" class=\"headerlink\" title=\"实验结果\"></a>实验结果</h4><ul>\n<li>数据集：</li>\n</ul>\n<img src=\"../static/images/datasets.png\">\n\n<center><strong>ICDAR 2013 handwriting recognition competition\ndataset and CASIA-HWDB</strong></center>\n\n\n<ul>\n<li>数据预处理</li>\n</ul>\n<ol>\n<li><p>倾斜校正</p>\n<ul>\n<li>倾斜角估计：使用黑点的坐标作为数据，利用该数据进行线性回归来进行拟合。</li>\n<li>$a$是倾斜线的坡度，$\\theta$为倾斜角度。</li>\n</ul>\n<p>$$<br>\\theta = - \\arctan (a)<br>$$</p>\n<ul>\n<li>旋转：对图像进行顺时针旋转$\\theta$度</li>\n<li>$(h,w)$是原始的形状，$(h_r, w_r)$是旋转后的形状；$(x,y)$是旋转前的坐标，$(x_r,y_r)$是旋转后的。</li>\n</ul>\n<p>$$<br>h_r = h * |\\cos (\\theta)| + w * |\\sin (\\theta)| \\<br>h_w = w * |\\cos (\\theta)| + w * |\\sin (\\theta)| \\<br>$$</p>\n<p>$$<br>\\begin {bmatrix}<br>x_r - \\frac{w_r}{2}\\<br>\\frac{h_r}{2}-y_r</p>\n<h1 id=\"end-bmatrix\"><a href=\"#end-bmatrix\" class=\"headerlink\" title=\"\\end {bmatrix}\"></a>\\end {bmatrix}</h1><p>\\begin {bmatrix}<br>\\cos (\\theta)&amp; \\sin (\\theta)\\<br>\\sin (\\theta)&amp; - \\cos (\\theta)<br>\\end {bmatrix}<br>.<br>\\begin {bmatrix}<br>x - \\frac{w}{2}\\<br>\\frac{h}{2} - y<br>\\end {bmatrix}<br>$$</p>\n</li>\n<li><p>空白去除</p>\n<ul>\n<li>1-$L_i^p$表示空白的概率</li>\n</ul>\n</li>\n<li><p>图片resize </p>\n<ul>\n<li>图像高度被正则化为128个像素。</li>\n</ul>\n</li>\n</ol>\n<ul>\n<li>数据增强<ul>\n<li>利用大量单个字的图片合成超过20万的文本行图片</li>\n</ul>\n</li>\n<li>训练策略<ul>\n<li>合成数据不会被用于更新detection 和 location的参数</li>\n</ul>\n</li>\n<li>准确度</li>\n</ul>\n<img src=\"../static/images/metric1.png\">\n\n<img src=\"../static/images/metric2.png\" height=\"150\">\n","categories":[{"name":"论文阅读","slug":"论文阅读","count":1,"path":"api/categories/论文阅读.json"}],"tags":[{"name":"手写字识别","slug":"手写字识别","count":1,"path":"api/tags/手写字识别.json"},{"name":"中文","slug":"中文","count":1,"path":"api/tags/中文.json"}]}